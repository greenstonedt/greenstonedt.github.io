{"version":3,"sources":["assets/Script/IngameScene.js","assets/Script/InputFrameController.js","assets/Script/LandingScene.js","assets/Script/ResultPopup.js","assets/Script/RiddleFrameController.js","assets/Script/component/ScoreLabel.js","assets/Script/constants.js","assets/Script/lib/helpers.js","assets/Script/lib/riddleGenerate.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA;;AACA;;AAEA;AACI;AAEA;AACI;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAjBQ;AAoBZ;AAEA;AACI;AACA;AACA;AACA;AACA;AACH;AAED;AACI;AACA;AACA;AACH;AAED;AAAY;;AACR;AACI;AACA;AACA;AAEA;AACA;;AAEA;AACI;AACA;AACA;AACA;AACI;AACH;AACJ;AACG;AACA;;AACA;AACI;AACA;AACc;AAAD;AACC;AAAD;;AAEb;AACI;AAAyB;AAAsD;AAClF;AACJ;AACJ;AACJ;AACJ;AAED;AAEA;AAAoB;;AAChB;AACA;AACI;AACA;;AACA;AACH;AACJ;AAED;AACI;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACH;AAED;AACI;;AACA;AACI;AACA;AACA;AACA;AACH;AACG;AACH;;AACD;AACH;AAED;AACI;AACA;AACA;AACA;AACH;AAED;AAEA;AAAkB;;AACd;AAGQ;;AACA;AACA;AACH;AACW;AAAS;AAAU;AAAZ;AAAT;AAEE;AAAS;AAAa;AAAf;AAAT;AAEN;;AACA;AACA;AACH;AACU;AAAS;AAAY;AAAd;AAAT;AACE;AAAS;AAAY;AAAd;AAAT;AACK;AAAO;AAE5B;AAED;AACI;AACA;AACA;AACA;AACA;AACA;AACe;AAAS;AAAU;AAAZ;AAAT;AAGL;AACH;AAER;AAED;AAAoB;;AAChB;AACA;AACA;AACA;AACA;AACA;AACe;AAAS;AAAU;AAAZ;AAAT;AAEG;AAAS;AAAU;AAAZ;AAAT;AAEN;AACA;AACA;AACH;AAER;AAED;AACI;AACA;AACc;AAAY;AAAb;AAEC;AAAY;AAAb;AAEhB;AAED;AAAoB;;AAChB;AACA;AACA;AACA;AACA;AAEc;AAAS;AAAU;AAAZ;AAAR;AAEC;AAAD;AAEL;AACH;AAER;AAED;AAAuB;;AACnB;AACA;AACA;AACA;AACc;AAAuB;AAAxB;AAEC;AAAyB;AAA1B;AAEL;AACA;AACA;AACH;AACR;AAED;AAEA;AAAuB;;AACnB;AACA;AACA;AACA;;AAGA;AACI;AACI;AACH;AACG;AACH;;AACD;AACA;AACA;AAEA;AAEc;AAAD;AAEL;;AACA;;AACA;AACI;AACA;AACc;AAAY;AAAb;AACC;AAAY;AAAb;AAEhB;AACJ;AACS;AAAD;AACC;AAAD;AACC;AAAD;AACC;AAAD;AACC;AAAD;;AAGb;AACI;AACH;AACJ;;AAED;AACA;AAEA;AACA;AACI;AACI;AACH;AACG;;AACA;AACA;AACH;AACJ;AACJ;AAED;AACI;AACA;AACH;AAhSI;;;;;;;;;;ACPT;AACA;AACA;AACA;AACA;AACA;AAEA;AACI;AACA;AACI;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAfQ;AAkBZ;AAEA;AACI;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA;AACA;AACH;AAED;AAIA;AACI;AACI;AACH;AACJ;AAED;AACI;AACI;AACA;AACH;;AACD;AACI;AACA;AACI;AACA;;AACJ;AACA;AACI;AACA;;AACJ;AACA;AACI;AACA;;AACJ;AACA;AACI;AACA;;AACJ;AACA;AACI;AACA;;AACJ;AACA;AACI;AACA;;AACJ;AACA;AACI;AACA;;AACJ;AACA;AACI;AACA;;AACJ;AACI;AACI;AACA;AACH;;AACL;AACI;AACA;;AACJ;AACA;AACI;AACA;;AACJ;AACI;AACA;;AACJ;AACA;AACI;AACA;;AACJ;AACA;AACI;AACA;;AACJ;AACA;AACI;AACA;;AACJ;AACA;AACA;AACI;AACA;;AACJ;AACI;AACI;AACA;AACH;;AACL;AACA;AACA;AACA;AACA;AA1EJ;AA4EH;AAED;AACI;AACI;AACI;AACA;;AACJ;AACI;AACA;;AACJ;AACI;AACA;;AACJ;AACI;AACA;;AACJ;AACI;AACA;;AACJ;AACI;AACA;;AACJ;AACI;AACA;;AACJ;AACI;AACA;;AACJ;AACI;AACA;;AACJ;AACI;AACA;;AACJ;AACI;AACA;;AACJ;AACI;AACA;;AACJ;AACI;AACA;;AACJ;AACI;AACA;;AACJ;AACI;AACA;AACJ;AACA;AACA;;AACA;AACI;AAlDR;AAoDH;;AA/LI;;;;;;;;;;ACPT;AACA;AACA;AACA;AACA;AACA;AAEA;AACI;AAEA;AACI;AACA;AAFQ;AAKZ;AAEA;AAEA;AACI;AACA;AACA;AACH;AAED;AACI;AACA;AACH;;AArBI;;;;;;;;;;ACPT;AACI;AAEA;AACI;AACA;AACA;AACA;AAEA;AANQ;AASZ;AAEA;AAEA;AAIA;AACI;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACc;AAAQ;AAAU;AAAX;AAAR;AAEhB;AAED;AAAiB;;AACb;;AACA;AACI;AACA;AACH;AACG;AACU;AAAQ;AAAU;AAAX;AAAR;AAEL;AACH;AAEJ;AACJ;AAED;AACI;AACA;AACH;AAED;AACI;AACA;AACH;;AA3DI;;;;;;;;;;ACAT;;AACA;;AAEA;AACI;AAEA;AACI;AACA;AACA;AACA;AACA;AAEA;AAPQ;AAUZ;AAEA;AACI;AACA;AACH;AAED;AAGA;AACI;AACA;;AACA;AACI;;AACA;AACI;AACA;AACA;;AACA;AACI;AACH;AACJ;AACJ;AACG;AACA;AACA;AAEH;AACG;AACA;AACH;AACJ;AAED;AACI;AACA;AACH;AAED;AACI;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;;AAEA;AACI;AACI;AACA;AACA;;AACJ;AACI;AACA;AACA;;AACJ;AACI;AACA;AACA;;AACJ;AACI;AACA;AACA;AAhBR;;AAkBA;;AACA;;AACA;;AAEA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACH;;AAnGI;;;;;;;;;;ACHT;AAEA;AACI;AAEA;AAGA;AAEA;AAEA;AACI;AACA;AACA;AACA;AACA;AAEA;AACA;AACH;AAED;AAAsC;AAArB;AAAqB;;AAClC;;AACA;AACI;AACA;AACA;AACH;AACG;AACA;AACH;AACJ;AAED;AACI;AACI;AACA;AACH;AACG;AACA;AACH;;AACD;AACI;AACA;AACH;AACJ;AA7CI;;;;;;;;;;ACFT;AACE;AACA;AACA;AACA;AACA;AACA;AANe;;;;;;;;;;ACAjB;AACI;AACH;;AAED;AACI;AAGH;;AAED;AACI;AACI;AACI;;AACJ;AACI;;AACJ;AACI;AAAuC;;AAC3C;AACA;AACI;AATR;AAWH;;AAED;AACI;AACI;AACI;;AACJ;AACI;;AACJ;AACI;;AACJ;AACI;AACI;AACI;AACI;;AACJ;AACI;;AACJ;AACI;;AACJ;AACI;;AACJ;AACI;AAVR;AAYH;;AArBT;;AAuBA;AACH;;AAED;AACI;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACI;AACA;AACA;AACA;AAJG;AAMV;;AAED;AACI;AADyC;AAAA;AAAA;AAAA;AAGzC;AACA;;AACA;AACI;AACH;;AACD;AACI;AACH;;AACD;AACH;;;;;;;;;;AClFD;;AAEA;AACE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA;AACE;AACA;AACA;AACA;AACD;AACC;AACA;AACA;AACA;AACD;AACC;AACA;AACA;AACA;AACA;AACD;AACC;AACA;AACA;AACA;AACA;AACD;;AACD;;AACA;AACE;AACE;AACA;;AACF;AACE;AACA;;AACF;AACE;AACA;;AACF;AACE;AACA;AAZJ;;AAaC;AAED;AACE;AACA;AACA;AACA;AACA;AALK;AAOR","sourcesContent":["const RiddleFrameController = require('RiddleFrameController');\nconst ResultPopup = require('ResultPopup');\nconst ScoreLabel = require('./component/ScoreLabel');\nconst constants = require('./constants');\nconst helpers = require('./lib/helpers');\nconst riddleGenerate = require('./lib/riddleGenerate');\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        riddleFrameCtor: RiddleFrameController,\n        resultPopup: ResultPopup,\n        notificaitonText: cc.Label,\n        resultText: cc.Label,\n        timerProgressBar: cc.ProgressBar,\n        timerText: cc.Label,\n        questtionText: cc.Label,\n        scoreText: ScoreLabel,\n        chainText: cc.Label,\n        highscoreText: cc.Label,\n\n        //audio\n        timerTickSound: cc.AudioClip,\n        correctSound: cc.AudioClip,\n        wrongSound: cc.AudioClip,\n        gameOverSound: cc.AudioClip,\n        levelUpSound: cc.AudioClip\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad () {\n        this.rand = require('random-seed').create();\n        this.rand.initState();\n        this.rand.seed(Math.random());\n        this.riddleFrameCtor.node.on('answer', this.onResult, this);\n        this.resultPopup.node.on('restart', this.onRestart, this);\n    },\n\n    start () {\n        this.resetAndStartGame();\n        this.resultPopup.node.active = true;\n        this.resultPopup.hide(true);\n    },\n\n    update (dt) {\n        if (this.isPlaying) {\n            this.timer -= dt * 1000;\n            this.timerText.string = helpers.formatTimer(this.timer + '');\n            this.timerProgressBar.progress = this.timer / constants.ROUND_DURATION;\n\n            this.chainTimer -= dt * 1000;\n            this.timerProgressBar.barSprite.node.color = new cc.Color(255, this.timer / constants.ROUND_DURATION * 255, this.timer / constants.ROUND_DURATION * 255, 255);\n\n            if (this.timer < 0) {\n                this.isPlaying = false;\n                this.riddleFrameCtor.locked = true;\n                cc.audioEngine.play(this.gameOverSound, false, 1);\n                this.animateEndGame(() => {\n                    this.resultPopup.show(this.score);\n                });\n            } else if (this.timer < 10000) {\n                let timerBySecond = this.timer / 1000;\n                let ceil = Math.ceil(timerBySecond);\n                if (timerBySecond + dt > ceil) {\n                    cc.audioEngine.play(this.timerTickSound, false, 0.5);\n                    cc.tween(this.timerText.node)\n                        .to(0.1, {color: new cc.Color().fromHEX('#d35400')})\n                        .to(0.1, {color: new cc.Color().fromHEX('#ffffff')})\n                        .start();\n                    if (this.timer < 5000) {\n                        this.scheduleOnce(() => {cc.audioEngine.play(this.timerTickSound, false, 0.5);}, 0.5)\n                    }\n                }\n            }\n        }\n    },\n\n    // MAIN FUNCS\n\n    resetAndStartGame() {\n        this.reset();\n        this.animateGoText(() => {\n            this.notificaitonText.node.active = false;\n            this.riddleFrameCtor.node.active = true;\n            this.startNewRiddle();\n        });\n    },\n\n    reset() {\n        this.isPlaying = false;\n\n        this.questionNumber = 0;\n        this.level = 0;\n        this.chain = 0;\n        this.timer = constants.ROUND_DURATION;\n        this.chainTimer = 0;\n        this.score = 0;\n        this.displayingScore = 0;\n\n        this.highscoreText.node.active = false;\n        this.chainText.node.active = false;\n        this.resultText.node.active = false;\n        this.riddleFrameCtor.node.active = false;\n        this.notificaitonText.node.active = true;\n        this.notificaitonText.node.setScale(0);\n        this.timerProgressBar.progress = 1;\n        this.timerProgressBar.barSprite.node.color = new cc.Color().fromHEX('#ffffff');\n\n        this.timerText.string = helpers.formatTimer(this.timer + '');\n        this.questtionText.string = `Level ${this.level + 1}-${this.questionNumber + 1}`;\n        this.scoreText.setScore(this.score, true);\n    },\n\n    nextRiddle () {\n        this.questionNumber++;\n        if (this.questionNumber >= constants.DIFFICULTY_STEP) {\n            this.questionNumber = 0;\n            this.level++;\n            this.timer = constants.ROUND_DURATION;\n            this.animateLevelUp(this.startNewRiddle.bind(this));\n        } else {\n            this.startNewRiddle();\n        }\n        this.animateQuestionInfo();\n    },\n\n    startNewRiddle() {\n        let riddleData = riddleGenerate(this.level + 1, this.rand);\n        this.riddleFrameCtor.optainNewRiddle(riddleData);\n        this.isPlaying = true;\n        this.chainTimer = constants.CHAIN_DURATION;\n    },\n\n    /// ANIMATIONS\n\n    animateGoText(cb) {\n        cc.tween(this.notificaitonText.node)\n            .delay(0.4)\n            .call(() => {\n                this.notificaitonText.node.setScale(0.3);\n                this.notificaitonText.string = 'READY'\n                cc.audioEngine.play(this.timerTickSound, false, 1.0);\n            })\n            .to(0.35, { scale: { value: 1, easing: 'sineOut' } })\n            .delay(0.2)\n            .to(0.35, { scale: { value: 0.35, easing: 'sineIn' } })\n            .call(() => {\n                this.notificaitonText.node.setScale(0.4);\n                this.notificaitonText.string = 'GO!'\n                cc.audioEngine.play(this.gameOverSound, false, 1.0);\n            })\n            .to(0.5, { scale: { value: 1.3, easing: 'sineOut' } })\n            .to(0.3, { scale: { value: 1.2, easing: 'sineIn' } })\n            .call(() => { cb(); })\n            .start();\n    },\n\n    animateEndGame (cb) {\n        this.riddleFrameCtor.node.active = false;\n        this.notificaitonText.node.active = true;\n        this.notificaitonText.string = 'TIME UP!';\n        this.notificaitonText.node.setScale(0.3);\n        this.notificaitonText.node.color = new cc.Color().fromHEX('#d35400');\n        cc.tween(this.notificaitonText.node)\n            .to(0.3, { scale: { value: 1, easing: 'sineOut' } })\n            .delay(0.4)\n            .call(() => {\n                cb();\n            })\n            .start();\n    },\n\n    animateLevelUp (cb) {\n        cc.audioEngine.play(this.levelUpSound, false, 1);\n        this.riddleFrameCtor.node.active = false;\n        this.notificaitonText.node.active = true;\n        this.notificaitonText.string = 'LEVEL UP!';\n        this.notificaitonText.node.setScale(0.3);\n        cc.tween(this.notificaitonText.node)\n            .to(0.3, { scale: { value: 1, easing: 'sineOut' } })\n            .delay(0.3)\n            .to(0.15, { scale: { value: 0, easing: 'sineOut' } })\n            .call(() => {\n                this.riddleFrameCtor.node.active = true;\n                this.notificaitonText.node.active = false;\n                cb();\n            })\n            .start();\n    },\n\n    animateQuestionInfo () {\n        this.questtionText.string = `Level ${this.level+1}-${this.questionNumber+1}`;\n        cc.tween(this.questtionText.node)\n            .to(0.1, {scale: 1.2, color: new cc.Color().fromHEX('#16a085')}, )\n            .delay(0.05)\n            .to(0.1, {scale: 1.0, color: new cc.Color().fromHEX('#ECF0F1')}, )\n            .start();\n    },\n\n    animateChainText () {\n        this.chainText.node.active = true;\n        this.chainText.node.x = this.scoreText.node.width / 2 - 10;\n        this.chainText.node.setScale(0);\n        this.chainText.string = `Chain x${this.chain}`;\n        cc.tween(this.chainText.node)\n            .delay(0.2)\n            .to(0.2, {scale: { value: 1, easing: 'bounceOut' }})\n            .delay(0.3)\n            .to(0.2, {scale: 0})\n            .call(() => {\n                this.chainText.node.active = false;\n            })\n            .start();\n    },\n\n    animateResultText (cb) {\n        this.resultText.node.y = -30;\n        this.resultText.node.active = true;\n        this.resultText.node.opacity = 0;\n        cc.tween(this.resultText.node)\n            .to(0.2, {position: cc.v2(0, 0), opacity: 255})\n            .delay(0.4)\n            .to(0.2, {position: cc.v2(0, -30), opacity: 0})\n            .call(() => {\n                this.resultText.node.active = false;\n                this.riddleFrameCtor.locked = false;\n                cb();\n            }).start();\n    },\n\n    /// EVENT CALLBACKS\n\n    onResult(answerResult) {\n        if (!this.isPlaying) return;\n        this.isPlaying = false;\n        this.riddleFrameCtor.locked = true;\n        let isCorrect = answerResult === 'correct';\n\n        //Scoring\n        if (isCorrect) {\n            if (this.chainTimer > 0) {\n                this.chain = Math.min(++this.chain, constants.MAX_CHAIN);\n            } else {\n                this.chain = 0;\n            }\n            let gainedScore = constants.SCORING * Math.max(this.chain, 1);\n            let animatedStepScore = gainedScore / 6;\n            this.score += gainedScore;\n            \n            cc.tween(this.scoreText.node)\n                .delay(0.2)\n                .to(0.1, {color: new cc.Color().fromHEX('#ffffff')})\n                .call(()=> {\n                    this.scoreText.setScore(this.score);\n                    let highscore = cc.sys.localStorage.getItem('highscore') || 0;\n                    if (this.score > highscore) {\n                        this.highscoreText.node.active = true;\n                        cc.tween(this.highscoreText.node)\n                            .to(0.1, {scale: 1.1, color: new cc.Color().fromHEX('#F1C40F')})\n                            .to(0.1, {scale: 1.0, color: new cc.Color().fromHEX('#f39c12')})\n                            .start();\n                    }\n                })\n                .to(0.1, {color: new cc.Color().fromHEX('#ffffff')})\n                .to(0.1, {color: new cc.Color().fromHEX('#e67e22')})\n                .to(0.1, {color: new cc.Color().fromHEX('#ffffff')})\n                .to(0.1, {color: new cc.Color().fromHEX('#e67e22')})\n                .to(0.1, {color: new cc.Color().fromHEX('#ffffff')})\n                .start();\n\n            if (this.chain > 1) {\n                this.animateChainText();\n            }\n        }\n\n        this.resultText.string = isCorrect ? 'CORRECT' : 'INCORRECT';\n        this.resultText.node.color = new cc.Color().fromHEX(isCorrect ? '#16a085' : '#d35400');\n        \n        cc.audioEngine.play(isCorrect ? this.correctSound : this.wrongSound, false, 1);\n        this.animateResultText(() => {\n            if (isCorrect) {\n                this.nextRiddle();\n            } else {\n                this.riddleFrameCtor.clearInput();\n                this.chainTimer = -1;\n                this.isPlaying = true;\n            }\n        });\n    },\n\n    onRestart () {\n        this.resultPopup.hide();\n        this.resetAndStartGame()\n    }\n});\n","// Learn cc.Class:\n//  - https://docs.cocos.com/creator/manual/en/scripting/class.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\n\ncc.Class({\n    extends: cc.Component,\n    properties: {\n        button_0: cc.Button,\n        button_1: cc.Button,\n        button_2: cc.Button,\n        button_3: cc.Button,\n        button_4: cc.Button,\n        button_5: cc.Button,\n        button_6: cc.Button,\n        button_7: cc.Button,\n        button_8: cc.Button,\n        button_9: cc.Button,\n        button_Plus: cc.Button,\n        button_Minus: cc.Button,\n        button_Multiple: cc.Button,\n        button_Divide: cc.Button,\n        button_C: cc.Button,\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad () {\n        this.isKeyboardShifed = false;\n        this.button_0.node.on('click', this.onButtonClicked, this);\n        this.button_1.node.on('click', this.onButtonClicked, this);\n        this.button_2.node.on('click', this.onButtonClicked, this);\n        this.button_3.node.on('click', this.onButtonClicked, this);\n        this.button_4.node.on('click', this.onButtonClicked, this);\n        this.button_5.node.on('click', this.onButtonClicked, this);\n        this.button_6.node.on('click', this.onButtonClicked, this);\n        this.button_7.node.on('click', this.onButtonClicked, this);\n        this.button_8.node.on('click', this.onButtonClicked, this);\n        this.button_9.node.on('click', this.onButtonClicked, this);\n        this.button_Plus.node.on('click', this.onButtonClicked, this);\n        this.button_Minus.node.on('click', this.onButtonClicked, this);\n        this.button_Multiple.node.on('click', this.onButtonClicked, this);\n        this.button_Divide.node.on('click', this.onButtonClicked, this);\n        this.button_C.node.on('click', this.onButtonClicked, this);\n        // this.button_Enter.node.on('click', this.onButtonClicked, this);\n\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP, this.onKeyPressed, this);\n    },\n\n    start () {\n\n    },\n\n    onKeyDown (event) {\n        if (event.keyCode === cc.macro.KEY.shift) {\n            this.isKeyboardShifed = true;\n        }\n    },\n\n    onKeyPressed (event) {\n        if (event.keyCode === cc.macro.KEY.shift) {\n            this.isKeyboardShifed = false;\n            return;\n        }\n        switch(event.keyCode) {\n            case cc.macro.KEY['0']:\n            case cc.macro.KEY.num0:\n                this.node.emit('input', 0);\n                break;\n            case cc.macro.KEY['1']:\n            case cc.macro.KEY.num1:\n                this.node.emit('input', 1);\n                break;\n            case cc.macro.KEY['2']:\n            case cc.macro.KEY.num2:\n                this.node.emit('input', 2);\n                break;\n            case cc.macro.KEY['3']:\n            case cc.macro.KEY.num3:\n                this.node.emit('input', 3);\n                break;\n            case cc.macro.KEY['4']:\n            case cc.macro.KEY.num4:\n                this.node.emit('input', 4);\n                break;\n            case cc.macro.KEY['5']:\n            case cc.macro.KEY.num5:\n                this.node.emit('input', 5);\n                break;\n            case cc.macro.KEY['6']:\n            case cc.macro.KEY.num6:\n                this.node.emit('input', 6);\n                break;\n            case cc.macro.KEY['7']:\n            case cc.macro.KEY.num7:\n                this.node.emit('input', 7);\n                break;\n            case cc.macro.KEY['8']:\n                if (this.isKeyboardShifed) {\n                    this.node.emit('input', '*');\n                    break;\n                }\n            case cc.macro.KEY.num8:\n                this.node.emit('input', 8);\n                break;\n            case cc.macro.KEY['9']:\n            case cc.macro.KEY.num9:\n                this.node.emit('input', 9);\n                break;\n            case cc.macro.KEY[\"+\"]:\n                this.node.emit('input', '+');\n                break;\n            case cc.macro.KEY.dash:\n            case cc.macro.KEY[\"-\"]:\n                this.node.emit('input', '-');\n                break;\n            case cc.macro.KEY[\"*\"]:\n            case cc.macro.KEY.x:\n                this.node.emit('input', '*');\n                break;\n            case cc.macro.KEY.forwardslash:\n            case cc.macro.KEY[\"/\"]:\n                this.node.emit('input', '/');\n                break;\n            case cc.macro.KEY.numdel:\n            case cc.macro.KEY.Delete:\n            case cc.macro.KEY.backspace:\n                this.node.emit('input', 'C');\n                break;\n            case cc.macro.KEY.equal:\n                if (this.isKeyboardShifed) {\n                    this.node.emit('input', '+');\n                    break;\n                }\n            // case cc.macro.KEY.enter:\n            // case cc.macro.KEY.space:\n            // case cc.macro.KEY[\"=\"]:\n            //     this.node.emit('input', 'Enter');\n            //     break;\n        }\n    },\n\n    onButtonClicked (button) {\n        switch (button) {\n            case this.button_0:\n                this.node.emit('input', 0);\n                break;\n            case this.button_1:\n                this.node.emit('input', 1);\n                break;\n            case this.button_2:\n                this.node.emit('input', 2);\n                break;\n            case this.button_3:\n                this.node.emit('input', 3);\n                break;\n            case this.button_4:\n                this.node.emit('input', 4);\n                break;\n            case this.button_5:\n                this.node.emit('input', 5);\n                break;\n            case this.button_6:\n                this.node.emit('input', 6);\n                break;\n            case this.button_7:\n                this.node.emit('input', 7);\n                break;\n            case this.button_8:\n                this.node.emit('input', 8);\n                break;\n            case this.button_9:\n                this.node.emit('input', 9);\n                break;\n            case this.button_Plus:\n                this.node.emit('input', '+');\n                break;\n            case this.button_Minus:\n                this.node.emit('input', '-');\n                break;\n            case this.button_Multiple:\n                this.node.emit('input', '*');\n                break;\n            case this.button_Divide:\n                this.node.emit('input', '/');\n                break;\n            case this.button_C:\n                this.node.emit('input', 'C');\n                break;\n            // case this.button_Enter:\n            //     this.node.emit('input', 'Enter');\n            //     break;\n            default:\n                cc.error('undefined input button');\n        }\n    }\n\n    // update (dt) {},\n});\n","// Learn cc.Class:\n//  - https://docs.cocos.com/creator/manual/en/scripting/class.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        highscoreText: cc.Label,\n        clickSound: cc.AudioClip\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    // onLoad () {},\n\n    start () {\n        let highscore = cc.sys.localStorage.getItem('highscore') || 0;\n        this.highscoreText.string = `-HIGHSCORE: ${highscore}-`;\n        this.highscoreText.node.active = highscore > 0;\n    },\n\n    onPlayButtonClicked () {\n        cc.director.loadScene(\"ingame\");\n        cc.audioEngine.play(this.clickSound, false, 1);\n    }\n\n    // update (dt) {},\n});\n","cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        overlay: cc.Node,\n        frame: cc.Node,\n        scoreText: cc.Label,\n        highScoreText: cc.Label,\n\n        clickSound: cc.AudioClip\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    // onLoad () {},\n\n    start () {\n\n    },\n\n    show (score) {\n        this.overlay.active = true;\n        this.frame.active = true;\n        this.scoreText.string = 'You scored: ' + score;\n\n        let highscore = cc.sys.localStorage.getItem('highscore') || 0;\n        let isHighscore = score > highscore;\n        if (isHighscore) cc.sys.localStorage.setItem('highscore', score);\n        this.highScoreText.node.active = isHighscore;\n        \n        this.frame.setScale(0.3);\n        cc.tween(this.frame)\n            .to(0.4, {scale: {value: 1, easing: 'sineInOut'}})\n            .start();\n    },\n\n    hide (immediate) {\n        this.overlay.active = false;\n        if (immediate) {\n            this.frame.active = false;\n            this.frame.setScale(0);\n        }else {\n            cc.tween(this.frame)\n            .to(0.4, {scale: {value: 0, easing: 'sineInOut'}})\n            .call(() => {\n                this.frame.active = false;\n            })\n            .start();\n        }\n    },\n\n    onBackToMenuClicked () {\n        cc.audioEngine.play(this.clickSound, false, 1);\n        cc.director.loadScene(\"landing\");\n    },\n\n    onRestartClicked () {\n        cc.audioEngine.play(this.clickSound, false, 1);\n        this.node.emit('restart');\n    }\n\n    // update (dt) {},\n});\n","var InputFrameController = require('InputFrameController');\nvar helpers = require('./lib/helpers');\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        inputCtor: InputFrameController,\n        leftRiddleText: cc.Label,\n        rightRiddleText: cc.Label,\n        inputText: cc.Label,\n        inputFrame: cc.Sprite,\n\n        inputSound: cc.AudioClip\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad () {\n        this.locked = true;\n        this.inputCtor.node.on('input', this.onInput, this)\n    },\n\n    start () {\n    },\n\n    onInput (value) {\n        if (this.locked) return;\n        if (!this.currentRiddle) return;\n        if (!isNaN(value) && this.currentRiddle.riddlePart !== 'operator') {\n            if (this.input === null) this.input = 0;\n            if (this.input <= 99) {\n                this.input = this.input * 10 + value;\n                this.inputText.string = this.input > 0 ? this.input.toString() : '';\n                cc.log(this.input.length, helpers.getAnswerLength(this.currentRiddle));\n                if (this.input.toString().length >= helpers.getAnswerLength(this.currentRiddle)) {\n                    this.node.emit('answer', helpers.checkAnswer(this.currentRiddle, this.input) ? 'correct' : 'incorrect');\n                } else cc.audioEngine.play(this.inputSound, false, 1);\n            }\n        } else if (this.currentRiddle.riddlePart === 'operator' && helpers.isInputOperator(value)) {\n            this.input = value;\n            this.inputText.string = helpers.getInputCharacter(value);\n            this.node.emit('answer', helpers.checkAnswer(this.currentRiddle, this.input) ? 'correct' : 'incorrect');\n            // cc.audioEngine.play(this.inputSound, false, 1);\n        } else if (value === 'C') {\n            this.clearInput();\n            cc.audioEngine.play(this.inputSound, false, 1);\n        }\n    },\n\n    clearInput () {\n        this.input = null;\n        this.inputText.string = '';\n    },\n\n    optainNewRiddle (opts) {\n        opts = opts || {};\n        this.currentRiddle = {};\n        this.currentRiddle.operand1 = opts.operand1 || 0;\n        this.currentRiddle.operand2 = opts.operand2 || 0;\n        this.currentRiddle.result = opts.result || 0;\n        this.currentRiddle.operator = opts.operator || '+';\n        this.currentRiddle.riddlePart = opts.riddlePart || 'operator';\n\n        this.clearInput();\n\n        const INPUT_FRAME_PADDING = 8;\n        const INPUT_FRAME_NUMBERIC = 165;\n        const INPUT_FRAME_OPERATOR = 80\n        const INPUT_FRAME_WIDTH = this.currentRiddle.riddlePart === 'operator' ? INPUT_FRAME_OPERATOR : INPUT_FRAME_NUMBERIC;\n\n        switch (this.currentRiddle.riddlePart) {\n            case 'operand1':\n                this.leftRiddleText.string = '';\n                this.rightRiddleText.string = helpers.getInputCharacter(this.currentRiddle.operator) + ' ' + this.currentRiddle.operand2 + ' = ' + this.currentRiddle.result;\n                break;\n            case 'operand2':\n                this.leftRiddleText.string = this.currentRiddle.operand1 + ' ' + helpers.getInputCharacter(this.currentRiddle.operator);\n                this.rightRiddleText.string = '= ' + this.currentRiddle.result;\n                break;\n            case 'result':\n                this.leftRiddleText.string = this.currentRiddle.operand1 + ' ' + helpers.getInputCharacter(this.currentRiddle.operator) + ' ' + this.currentRiddle.operand2 + ' =';\n                this.rightRiddleText.string = '';\n                break;\n            case 'operator':\n                this.leftRiddleText.string = this.currentRiddle.operand1;\n                this.rightRiddleText.string = this.currentRiddle.operand2 + ' = ' + this.currentRiddle.result;\n                break;\n        }\n        this.inputText.string = '';\n        this.leftRiddleText._forceUpdateRenderData();\n        this.rightRiddleText._forceUpdateRenderData();\n\n        this.inputFrame.node.width = INPUT_FRAME_WIDTH;\n        let contentWidth = this.leftRiddleText.node.width + this.rightRiddleText.node.width + this.inputFrame.node.width + INPUT_FRAME_PADDING * 2;\n\n        this.leftRiddleText.node.x = ( this.leftRiddleText.node.width - contentWidth ) / 2;\n        this.inputFrame.node.x = this.leftRiddleText.node.x + (this.leftRiddleText.node.width + this.inputFrame.node.width) / 2 + INPUT_FRAME_PADDING;\n        this.rightRiddleText.node.x = this.inputFrame.node.x + (this.inputFrame.node.width + this.rightRiddleText.node.width) / 2 + INPUT_FRAME_PADDING * 2;\n        this.inputText.node.x = this.inputFrame.node.x;\n\n        this.locked = false;\n    },\n\n    // update (dt) {},\n});\n","const FRAME_FOR_SCORE_ANIMATION = 20;\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    // onLoad () {},\n\n    start () {\n        this.label = this.getComponent(cc.Label);\n        this.displayingScore = 0;\n        this.lerpingScore = 0;\n        this.score = 0;\n        this.label.string = `- SCORE: ${this.displayingScore} -`;\n\n        this.lerpingTime = 0;\n        this.lerpingValue = 0;\n    },\n\n    setScore (value, immediately = false) {\n        this.score = value;\n        if (immediately) {\n            this.lerpingTime = 0;\n            this.lerpingValue = 0;\n            this.lerpingScore = this.score;\n        } else {\n            this.lerpingTime = FRAME_FOR_SCORE_ANIMATION;\n            this.lerpingValue = (this.score - this.lerpingScore) / FRAME_FOR_SCORE_ANIMATION\n        }\n    },\n\n    update (dt) {\n        if (this.lerpingTime <= 0) {\n            this.lerpingValue = 0;\n            this.lerpingScore = this.score;\n        } else if (this.lerpingTime > 0) {\n            this.lerpingScore += this.lerpingValue;\n            this.lerpingTime--;\n        }\n        if (this.displayingScore != this.lerpingScore) {\n            this.displayingScore = this.lerpingScore;\n            this.label.string = `- SCORE: ${~~this.displayingScore} -`;\n        }\n    },\n});\n","module.exports = { \n  ROUND_DURATION: 60000, \n  MULTIPLE_DIVIDE_INCLUDED_DIFFICULTY: 3,\n  CHAIN_DURATION: 3000, \n  DIFFICULTY_STEP: 10,\n  SCORING: 7,\n  MAX_CHAIN: 5\n}","module.exports.isInputOperator = function (value) {\n    return value === '+' || value === '-' || value === '*' || value === '/';\n};\n\nmodule.exports.getInputCharacter = function (value) {\n    if (value === '/') return '÷';\n    else if (value === '*') return 'x';\n    else return value;\n}\n\nmodule.exports.getAnswerLength = function (riddle) {\n    switch (riddle.riddlePart) {\n        case 'operand1':\n            return riddle.operand1.toString().length;\n        case 'operand2':\n            return riddle.operand2.toString().length;\n        case 'result':\n            return riddle.result.toString().length;;\n        case 'operator':\n        default:\n            return 1\n    }\n}\n\nmodule.exports.checkAnswer = function (riddle, answer) {\n    switch (riddle.riddlePart) {\n        case 'operand1':\n            return parseInt(answer) === riddle.operand1;\n        case 'operand2':\n            return parseInt(answer) === riddle.operand2;\n        case 'result':\n            return parseInt(answer) === riddle.result;\n        case 'operator':\n            if (answer !== riddle.operator) {\n                switch (answer) {\n                    case '+':\n                        return riddle.operand1 + riddle.operand2 === riddle.result;\n                    case '-':\n                        return riddle.operand1 - riddle.operand2 === riddle.result;\n                    case '*':\n                        return riddle.operand1 * riddle.operand2 === riddle.result;\n                    case '/':\n                        return riddle.operand1 / riddle.operand2 === riddle.result;\n                    default:\n                        return false;\n                }\n            } else return true;\n    }\n    return false;\n}\n\nmodule.exports.formatDurationDHMSObject = function (duration) {\n    duration = Math.max(0, duration);\n    let seconds = Math.ceil(duration / 1000);\n    let minutes = Math.floor(seconds / 60);\n    let hours = Math.floor(minutes / 60);\n    const days = Math.floor(hours / 24);\n\n    seconds %= 60;\n    minutes %= 60;\n    hours %= 24;\n\n    return {\n        seconds,\n        minutes,\n        hours,\n        days\n    };\n}\n\nmodule.exports.formatTimer = function (time) {\n    const remainingTime = this.formatDurationDHMSObject(time);\n    const { seconds, minutes, hours, days } = remainingTime;\n    let minutesString = minutes > 9 || hours === 0 ? minutes : '0' + minutes;\n    let secondString = seconds > 9 ? seconds : '0' + seconds;\n    if (days >= 1) {\n        return `${days}:${hours}:${minutes}:${seconds}`;\n    }\n    if (hours >= 1) {\n        return `${hours}:${minutesString}:${secondString}`;\n    }\n    return `${minutesString}:${secondString}`;\n}\n","const constants = require('../constants');\n\nmodule.exports = function (difficulty, rand) {\n  let type = rand.range(difficulty >= constants.MULTIPLE_DIVIDE_INCLUDED_DIFFICULTY ? 4 : 2);\n  let riddleType = rand(4);\n  let minValue = difficulty * 3;\n  let maxValue = difficulty * 10;\n  let result = 0;\n  let operand1 = 0;\n  let operand2 = 0;\n  let operator = '';\n  if (type === 0) {\n    operator = '+';\n    result = rand.intBetween(minValue, maxValue);\n    operand1 = rand.intBetween(1, result - 1);\n    operand2 = result - operand1;\n  } else if (type === 1) {\n    operator = '-';\n    operand1 = rand.intBetween(minValue, maxValue);\n    operand2 = rand.intBetween(1, operand1 - 1);\n    result = operand1 - operand2;\n  } else if (type === 2) {\n    operator = '*';\n    result = rand.intBetween(minValue, maxValue);\n    operand1 = rand.intBetween(2, result / 2 - 2);\n    operand2 = Math.round(result / operand1);\n    result = operand1 * operand2;\n  } else if (type === 3) {\n    operator = '/';\n    operand1 = rand.intBetween(minValue, maxValue);\n    operand2 = rand.intBetween(2, operand1 / 2 - 2);\n    result = Math.round(operand1 / operand2);\n    operand1 = result * operand2;\n  }\n  let riddlePart = 'result';\n  switch (riddleType) {\n    case 0:\n      riddlePart = 'result'\n      break;\n    case 1:\n      riddlePart = 'operand1'\n      break;\n    case 2:\n      riddlePart = 'operand2'\n      break;\n    case 3:\n      riddlePart = 'operator'\n      break;\n  };\n\n  return { \n    result, \n    operand1,\n    operand2,\n    operator,\n    riddlePart\n  }\n}\n"],"file":"index.js"}