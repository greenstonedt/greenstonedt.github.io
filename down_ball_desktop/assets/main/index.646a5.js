window.__require=function e(t,i,o){function c(n,s){if(!i[n]){if(!t[n]){var a=n.split("/");if(a=a[a.length-1],!t[a]){var l="function"==typeof __require&&__require;if(!s&&l)return l(a,!0);if(r)return r(a,!0);throw new Error("Cannot find module '"+n+"'")}n=a}var p=i[n]={exports:{}};t[n][0].call(p.exports,function(e){return c(t[n][1][e]||e)},p,p.exports,e,t,i,o)}return i[n].exports}for(var r="function"==typeof __require&&__require,n=0;n<o.length;n++)c(o[n]);return c}({block:[function(e,t){"use strict";cc._RF.push(t,"dfa28y7x0BNFZQ9xARhs4Og","block"),cc.Class({extends:cc.Component,properties:{leftSprite:cc.SpriteFrame,rightSprite:cc.SpriteFrame,middleSprite:cc.SpriteFrame,singleSprite:cc.SpriteFrame},onLoad:function(){this.sprite=this.getComponent(cc.Sprite)},start:function(){},setType:function(e){switch(e){case"left":this.sprite.spriteFrame=this.leftSprite;break;case"right":this.sprite.spriteFrame=this.rightSprite;break;case"middle":this.sprite.spriteFrame=this.middleSprite;break;default:this.sprite.spriteFrame=this.singleSprite}},update:function(){},move:function(e){this.node.y+=e}}),cc._RF.pop()},{}],ingameCtor:[function(e,t){"use strict";cc._RF.push(t,"f248dKnGNxJz51/88AFA/6x","ingameCtor");var i=r(e("./libs/perlin")),o=r(e("./block")),c=r(e("./ingameUICtor"));function r(e){return e&&e.__esModule?e:{default:e}}cc.Class({extends:cc.Component,properties:{uiController:c.default,ball:cc.Node,blockPrefab:cc.Prefab},onLoad:function(){this.uiController.ingameController=this,cc.director.getPhysicsManager().enabled=!0,cc.director.getPhysicsManager().gravity=cc.v2(0,-1e3);var e=cc.director.getPhysicsManager();e.enabledAccumulator=!0,e.FIXED_TIME_STEP=1/30,e.VELOCITY_ITERATIONS=8,e.POSITION_ITERATIONS=8,cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this),this.isLeftPressed=!1,this.isRightPressed=!1,this.blocksPerRow=this.node.width/40-2,cc.director.isPaused&&cc.director.resume()},start:function(){var e=this;this.blockPool=new cc.NodePool("block"),this.blocks=[],i.default.seed(Math.random());for(var t=0;t<5;++t){var c=cc.instantiate(this.blockPrefab);this.blockPool.put(c),(c=this.blockPool.get()).parent=this.node,c.position=cc.Vec3(40*t-80,100),c.getComponent(o.default).setType(0===t?"left":4===t?"right":"middle"),this.blocks.push(c)}this.spawningBlockY=-50,this.spawningBlockTime=0,this.checkAndCreateBlock(),cc.director.pause(),this.uiController.popupOverlay.active=!0,setTimeout(function(){e.uiController.showReadyLabel()},300),setTimeout(function(){e.uiController.hideReadyLabel(),e.uiController.popupOverlay.active=!1},1800),setTimeout(function(){cc.director.resume()},2e3)},checkAndCreateBlock:function(){for(;this.spawningBlockY>-320;){for(var e=(this.blocksPerRow-1)/2,t=[],c=0;c<this.blocksPerRow;c++)if(i.default.simplex2(c,this.spawningBlockTime)>0){if(this.blockPool.size()<=0){var r=cc.instantiate(this.blockPrefab);this.blockPool.put(r)}(a=this.blockPool.get()).parent=this.node,a.position=cc.Vec3(40*(-e+c),this.spawningBlockY),this.blocks.push(a),t.push(a)}else t.push(null);for(c=0;c<this.blocksPerRow;c++)if(t[c]){var n=!1,s=!1;c-1>=0&&t[c-1]&&(n=!0),c+1<this.blocksPerRow&&t[c+1]&&(s=!0);var a=t[c];n&&s?a.getComponent(o.default).setType("middle"):n?a.getComponent(o.default).setType("right"):s?a.getComponent(o.default).setType("left"):a.getComponent(o.default).setType("single")}this.spawningBlockY-=150,this.spawningBlockTime++}},update:function(e){var t=this,i=this.ball.getComponent(cc.RigidBody);this.isLeftPressed&&(0===i.linearVelocity.y&&(i.linearVelocity=cc.v2(Math.min(i.linearVelocity.x,0),i.linearVelocity.y)),i.applyLinearImpulse(cc.v2(-500*e,0),i.getWorldCenter())),this.isRightPressed&&(0===i.linearVelocity.y&&(i.linearVelocity=cc.v2(Math.max(i.linearVelocity.x,0),i.linearVelocity.y)),i.applyLinearImpulse(cc.v2(500*e,0),i.getWorldCenter())),this.spawningBlockY+=50*e,this.blocks.forEach(function(i){i.getComponent(o.default).move(50*e),i.position.y>320&&(t.blockPool.put(i),t.blocks.splice(t.blocks.indexOf(i),1))}),this.checkAndCreateBlock()},lateUpdate:function(){Math.abs(this.ball.y)>320&&this.endGame(),ballRigidBody=this.ball.getComponent(cc.RigidBody),ballRigidBody.linearVelocity=cc.v2(ballRigidBody.linearVelocity.x/Math.abs(ballRigidBody.linearVelocity.x)*Math.min(Math.abs(ballRigidBody.linearVelocity.x),250),ballRigidBody.linearVelocity.y),this.isRightPressed||this.isLeftPressed||0!==ballRigidBody.linearVelocity.y||(ballRigidBody.linearVelocity=cc.v2(.9*ballRigidBody.linearVelocity.x,ballRigidBody.linearVelocity.y))},pauseGame:function(){cc.director.pause(),this.uiController.showPopup("pause")},endGame:function(){cc.director.pause(),this.uiController.showPopup("result")},resumeGame:function(){cc.director.resume(),this.uiController.hidePopup()},quitGame:function(){cc.director.loadScene("landing")},restartGame:function(){cc.director.loadScene("ingame")},onKeyDown:function(e){switch(e.keyCode){case cc.macro.KEY.left:case cc.macro.KEY.dpadLeft:this.isLeftPressed=!0;break;case cc.macro.KEY.right:case cc.macro.KEY.dpadRight:this.isRightPressed=!0}},onKeyUp:function(e){switch(e.keyCode){case cc.macro.KEY.left:case cc.macro.KEY.dpadLeft:this.isLeftPressed=!1;break;case cc.macro.KEY.right:case cc.macro.KEY.dpadRight:this.isRightPressed=!1}}}),cc._RF.pop()},{"./block":"block","./ingameUICtor":"ingameUICtor","./libs/perlin":"perlin"}],ingameUICtor:[function(e,t){"use strict";cc._RF.push(t,"7bb42GScFVC54uXdQ4eXL54","ingameUICtor"),cc.Class({extends:cc.Component,properties:{popupOverlay:cc.Node,resultPopup:cc.Node,pausePopup:cc.Node,readyLabel:cc.Node},onLoad:function(){this.hideReadyLabel(),this.hidePopup()},start:function(){},hidePopup:function(){this.popupOverlay.active=!1,this.resultPopup.active=!1,this.pausePopup.active=!1},showPopup:function(e){switch(this.hidePopup(),this.popupOverlay.active=!0,e){case"pause":this.pausePopup.active=!0;break;case"result":this.resultPopup.active=!0}},hideReadyLabel:function(){this.readyLabel.active=!1},showReadyLabel:function(){this.readyLabel.active=!0},onResumeClicked:function(){this.ingameController.resumeGame(),this.hidePopup()},onPauseClicked:function(){this.ingameController.pauseGame()},onRestartClicked:function(){this.ingameController.restartGame()},onQuitClicked:function(){this.ingameController.quitGame()}}),cc._RF.pop()},{}],landingCtor:[function(e,t){"use strict";cc._RF.push(t,"ce4baYvJeFD6Jgwr6IrucOp","landingCtor"),cc.Class({extends:cc.Component,properties:{},start:function(){},onPlayClicked:function(){cc.director.loadScene("ingame")}}),cc._RF.pop()},{}],perlin:[function(e,t){"use strict";function i(e,t,i){this.x=e,this.y=t,this.z=i}cc._RF.push(t,"bd596Ss6v1BuIwW9SnsQQSk","perlin"),i.prototype.dot2=function(e,t){return this.x*e+this.y*t},i.prototype.dot3=function(e,t,i){return this.x*e+this.y*t+this.z*i};var o=[new i(1,1,0),new i(-1,1,0),new i(1,-1,0),new i(-1,-1,0),new i(1,0,1),new i(-1,0,1),new i(1,0,-1),new i(-1,0,-1),new i(0,1,1),new i(0,-1,1),new i(0,1,-1),new i(0,-1,-1)],c=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],r=new Array(512),n=new Array(512);t.exports.seed=function(e){e>0&&e<1&&(e*=65536),(e=Math.floor(e))<256&&(e|=e<<8);for(var t=0;t<256;t++){var i;i=1&t?c[t]^255&e:c[t]^e>>8&255,r[t]=r[t+256]=i,n[t]=n[t+256]=o[i%12]}},t.exports.seed(0);var s=.5*(Math.sqrt(3)-1),a=(3-Math.sqrt(3))/6;function l(e){return e*e*e*(e*(6*e-15)+10)}function p(e,t,i){return(1-i)*e+i*t}t.exports.simplex2=function(e,t){var i,o,c=(e+t)*s,l=Math.floor(e+c),p=Math.floor(t+c),d=(l+p)*a,u=e-l+d,h=t-p+d;u>h?(i=1,o=0):(i=0,o=1);var f=u-i+a,m=h-o+a,y=u-1+2*a,g=h-1+2*a,b=n[(l&=255)+r[p&=255]],v=n[l+i+r[p+o]],C=n[l+1+r[p+1]],k=.5-u*u-h*h,P=.5-f*f-m*m,w=.5-y*y-g*g;return 70*((k<0?0:(k*=k)*k*b.dot2(u,h))+(P<0?0:(P*=P)*P*v.dot2(f,m))+(w<0?0:(w*=w)*w*C.dot2(y,g)))},t.exports.simplex3=function(e,t,i){var o,c,s,a,l,p,d=(e+t+i)*(1/3),u=Math.floor(e+d),h=Math.floor(t+d),f=Math.floor(i+d),m=(u+h+f)*(1/6),y=e-u+m,g=t-h+m,b=i-f+m;y>=g?g>=b?(o=1,c=0,s=0,a=1,l=1,p=0):y>=b?(o=1,c=0,s=0,a=1,l=0,p=1):(o=0,c=0,s=1,a=1,l=0,p=1):g<b?(o=0,c=0,s=1,a=0,l=1,p=1):y<b?(o=0,c=1,s=0,a=0,l=1,p=1):(o=0,c=1,s=0,a=1,l=1,p=0);var v=y-o+1/6,C=g-c+1/6,k=b-s+1/6,P=y-a+1/6*2,w=g-l+1/6*2,R=b-p+1/6*2,x=y-1+.5,_=g-1+.5,S=b-1+.5,B=n[(u&=255)+r[(h&=255)+r[f&=255]]],M=n[u+o+r[h+c+r[f+s]]],E=n[u+a+r[h+l+r[f+p]]],F=n[u+1+r[h+1+r[f+1]]],L=.6-y*y-g*g-b*b,T=.6-v*v-C*C-k*k,V=.6-P*P-w*w-R*R,I=.6-x*x-_*_-S*S;return 32*((L<0?0:(L*=L)*L*B.dot3(y,g,b))+(T<0?0:(T*=T)*T*M.dot3(v,C,k))+(V<0?0:(V*=V)*V*E.dot3(P,w,R))+(I<0?0:(I*=I)*I*F.dot3(x,_,S)))},t.exports.perlin2=function(e,t){var i=Math.floor(e),o=Math.floor(t);e-=i,t-=o;var c=n[(i&=255)+r[o&=255]].dot2(e,t),s=n[i+r[o+1]].dot2(e,t-1),a=n[i+1+r[o]].dot2(e-1,t),d=n[i+1+r[o+1]].dot2(e-1,t-1),u=l(e);return p(p(c,a,u),p(s,d,u),l(t))},t.exports.perlin3=function(e,t,i){var o=Math.floor(e),c=Math.floor(t),s=Math.floor(i);e-=o,t-=c,i-=s;var a=n[(o&=255)+r[(c&=255)+r[s&=255]]].dot3(e,t,i),d=n[o+r[c+r[s+1]]].dot3(e,t,i-1),u=n[o+r[c+1+r[s]]].dot3(e,t-1,i),h=n[o+r[c+1+r[s+1]]].dot3(e,t-1,i-1),f=n[o+1+r[c+r[s]]].dot3(e-1,t,i),m=n[o+1+r[c+r[s+1]]].dot3(e-1,t,i-1),y=n[o+1+r[c+1+r[s]]].dot3(e-1,t-1,i),g=n[o+1+r[c+1+r[s+1]]].dot3(e-1,t-1,i-1),b=l(e),v=l(t),C=l(i);return p(p(p(a,f,b),p(d,m,b),C),p(p(u,y,b),p(h,g,b),C),v)},cc._RF.pop()},{}]},{},["block","ingameCtor","ingameUICtor","landingCtor","perlin"]);