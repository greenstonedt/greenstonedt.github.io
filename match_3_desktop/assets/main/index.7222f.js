window.__require=function e(t,i,o){function l(n,s){if(!i[n]){if(!t[n]){var r=n.split("/");if(r=r[r.length-1],!t[r]){var c="function"==typeof __require&&__require;if(!s&&c)return c(r,!0);if(a)return a(r,!0);throw new Error("Cannot find module '"+n+"'")}n=r}var u=i[n]={exports:{}};t[n][0].call(u.exports,function(e){return l(t[n][1][e]||e)},u,u.exports,e,t,i,o)}return i[n].exports}for(var a="function"==typeof __require&&__require,n=0;n<o.length;n++)l(o[n]);return l}({BoardCtor:[function(e,t){"use strict";cc._RF.push(t,"0ea50FT3DVG2K3QWJ/jwsKD","BoardCtor");var i=a(e("./constants")),o=a(e("./libs/helpers")),l=a(e("./objects/Tile"));function a(e){return e&&e.__esModule?e:{default:e}}cc.Class({extends:cc.Component,properties:{power1Frame:cc.SpriteFrame,power2Frame:cc.SpriteFrame,power3Frame:cc.SpriteFrame,power4Frame:cc.SpriteFrame,tilePrefab:cc.Prefab,scorePrefab:cc.Prefab},onLoad:function(){this.tilePool=new cc.NodePool("tile"),this.scoreTextPool=new cc.NodePool("scoreText"),this.ingameCtor=this.getComponent("IngameCtor"),this.node.on(cc.Node.EventType.TOUCH_START,this.onTouch,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnded,this)},init:function(){this.board=[],window.board=this.board,this.cellList=[],this.justSwappedCells=[];for(var e=0;e<i.default.BOARD_ROW_SIZE;e++){for(var t=[],o=0;o<i.default.BOARD_COLUMN_SIZE;o++){var l={x:o,y:e,tile:null};t.push(l),this.cellList.push(l)}this.board.push(t)}},reshuffleBoard:function(){var e=this;this.ingameCtor.uiController.showReshuffleNotification(),this.scheduleOnce(function(){e.animateReshuffleBoard(),e.scheduleOnce(e.generateTiles.bind(e,!1),i.default.ANIMATE_DURATION_CLEAR_BOARD_EACH_ROW+i.default.ANIMATE_DURATION_CLEAR_BOARD_BREAK_EACH_ROW*i.default.BOARD_ROW_SIZE)},i.default.ANIMATE_DURATION_NOTIF_SHOW+i.default.ANIMATE_DURATION_NOTIF_WAIT)},generateTiles:function(e){var t=this,o=[],l=i.default.BOARD_ROW_SIZE;this.cellList.forEach(function(i){null===i.tile&&(t.createTile(i,e?-2:-1),o.push(i),l=Math.min(l,i.y))}),this.animateDropGeneratedTiles(o,l),this.scheduleOnce(this.adjoinTiles.bind(this,null),i.default.ANIMATE_DURATION_DROP_GENERATED_TILES_EACH_ROW+i.default.ANIMATE_DURATION_DROP_GENERATED_TILES_BREAK_EACH_ROW*(i.default.BOARD_ROW_SIZE-l))},createTile:function(e,t){if(this.tilePool.size()<=0){var o=cc.instantiate(this.tilePrefab);this.tilePool.put(o)}var a,n=this.tilePool.get(),s=n.getComponent(l.default);if(n.parent=this.node,a=t>0?t:~~(Math.random()*i.default.TILE_TYPE_NORMAL_NUMBER),-2===t)for(var r=a;!this.checkforInitValidity(a,e);)if((a=(a+1)%i.default.TILE_TYPE_NORMAL_NUMBER)===r)return cc.error("check validity failed"),!1;return s.setup(a,e),e.tile=s,!0},swapTileAtCell:function(e,t){this.currentChain=0,this.ingameCtor.pauseGameForAnimating();for(var o=!1,l=0;l<this.currentPossibleMoves.length;l++){var a=this.currentPossibleMoves[l];if(a.toMove===e&&a.moveTo===t||a.toMove===t&&a.moveTo===e){o=!0;break}}if(o){var n=e.tile;e.tile=t.tile,t.tile=n,this.justSwappedCells=[e,t],this.animateSwap(e,t)}else this.animateSwapForthBack(e,t);this.scheduleOnce(this.activateSpecicalTiles.bind(this,e,t),o?i.default.ANIMATE_DURATION_SWAP:2*i.default.ANIMATE_DURATION_SWAP)},activateSpecicalTiles:function(e,t){var o=null,l=null;e.tile.type>=i.default.TILE_TYPE_NORMAL_NUMBER?e.tile.type===i.default.TILE_TYPE_INDEX_SPECIAL_MATCH&&t.tile.type>=i.default.TILE_TYPE_NORMAL_NUMBER?(o=t,l=e):(o=e,l=t):t.tile.type>=i.default.TILE_TYPE_NORMAL_NUMBER&&(o=t,l=e),null===o?this.adjoinTiles(null):o.tile.type===i.default.TILE_TYPE_INDEX_SPECIAL_LINE?this.activateLineTile(o,l):o.tile.type===i.default.TILE_TYPE_INDEX_SPECIAL_TIME?this.activateTimeTile(o,l):o.tile.type===i.default.TILE_TYPE_INDEX_SPECIAL_MATCH?this.activateMatchTile(o,l):this.adjoinTiles(null)},activateLineTile:function(e,t){var o=[];if(t.x===e.x)for(var l=0;l<i.default.BOARD_ROW_SIZE;l++)o.push(this.board[l][e.x]);else for(l=0;l<i.default.BOARD_COLUMN_SIZE;l++)o.push(this.board[e.y][l]);this.adjoinTiles(o)},activateTimeTile:function(e,t){var i=[e,t];this.adjoinTiles(i)},activateMatchTile:function(e,t){var i=[];i.push(e),this.cellList.forEach(function(e){e.tile&&e.tile.type===t.tile.type&&i.push(e)}),this.adjoinTiles(i)},adjoinTiles:function(e){void 0===e&&(e=null);var t=this.gatherAdjoinedLines(),o=this.gatherAdjoinedSpecialSpawns(t);this.justSwappedCells=[],t.length>0||e?(e&&t.push(e),this.scoring(t),this.animateAdjoin(t),o.length>0?this.scheduleOnce(this.spawnSpecialTiles.bind(this,o),i.default.ANIMATE_DURATION_ADJOIN):this.scheduleOnce(this.dropTiles,i.default.ANIMATE_DURATION_ADJOIN)):this.ingameCtor.checkForLevelCompleted()?this.ingameCtor.nextLevel():(this.currentPossibleMoves=this.gatherPossibleMoves(),0===this.currentPossibleMoves.length&&this.ingameCtor._time>0?this.reshuffleBoard():this.ingameCtor.resumeGameFromAnimating())},scoring:function(e){var t=this,l=o.default.getScoreScale(this.currentChain),a=[];e.forEach(function(e){e.forEach(function(e){if(!a.includes(e)){if(a.push(e),t.scoreTextPool.size()<=0){var n=cc.instantiate(t.scorePrefab);t.scoreTextPool.put(n)}var s=t.scoreTextPool.get(),r=s.getComponent(cc.Label);e.tile&&e.tile.type===i.default.TILE_TYPE_INDEX_SPECIAL_TIME?(s.parent=t.node,s.color=new cc.color("#FECA05"),r.string="+"+i.default.TILE_SPECIAL_BONUS_TIME,t.ingameCtor.addTime(i.default.TILE_SPECIAL_BONUS_TIME)):(s.parent=t.node,s.color=new cc.color("#ffffff"),r.string="+"+l,t.ingameCtor.addScore(l));var c=o.default.localPositionFromTileCoords(e.x,e.y);s.position=c,s.opacity=255,cc.tween(s).to(i.default.ANIMATE_DURATION_SCORE_TEXT,{position:{value:cc.v2(c.x-5+10*Math.random(),c.y+30*Math.random()+50),easing:"sineOutIn"},opacity:{value:0,easing:"sineOutIn"}}).call(function(){t.scoreTextPool.put(s)}).start()}})}),this.currentChain+=e.length},spawnSpecialTiles:function(e){var t=this,o=[];e.time.forEach(function(e){null===e.tile&&(t.createTile(e,i.default.TILE_TYPE_INDEX_SPECIAL_TIME),o.push(e))}),e.line.forEach(function(e){null===e.tile&&(t.createTile(e,i.default.TILE_TYPE_INDEX_SPECIAL_LINE),o.push(e))}),e.match.forEach(function(e){null===e.tile&&(t.createTile(e,i.default.TILE_TYPE_INDEX_SPECIAL_MATCH),o.push(e))}),o.forEach(function(e){var t=e.tile;t.node.scale=0,cc.tween(t.node).to(2*i.default.ANIMATE_DURATION_SPAWN_SPECIAL,{scale:{value:t.getDefaultScale(),easing:"sineOut"}}).start()}),this.dropTiles()},dropTiles:function(){var e=this.calculateDropTiles();this.animateDropTiles(e),this.scheduleOnce(this.generateTiles.bind(this,!1),i.default.ANIMATE_DURATION_DROP_TILES)},checkforInitValidity:function(e,t){return!(t.x>=2&&this.board[t.y][t.x-1].tile&&this.board[t.y][t.x-2].tile&&this.board[t.y][t.x-1].tile.type===e&&this.board[t.y][t.x-2].tile.type===e||t.y>=2&&this.board[t.y-1][t.x].tile&&this.board[t.y-2][t.x].tile&&this.board[t.y-1][t.x].tile.type===e&&this.board[t.y-2][t.x].tile.type===e)},calculateDropTiles:function(){for(var e=[],t=0;t<i.default.BOARD_COLUMN_SIZE;t++)for(var o=0;o<i.default.BOARD_ROW_SIZE;o++)if(null===this.board[o][t].tile)for(var l=o+1;l<i.default.BOARD_ROW_SIZE;l++)if(null!==this.board[l][t].tile){this.board[o][t].tile=this.board[l][t].tile,this.board[l][t].tile=null,this.board[o][t].tile.cell=this.board[o][t],e.push(this.board[o][t]);break}return e},gatherPossibleMoves:function(){var e=this,t=[];return this.cellList.forEach(function(o){var l=o.x,a=o.y,n=null,s=e.getTileTypeAtCell(l,a);if(s>=i.default.TILE_TYPE_NORMAL_NUMBER)null!==(n=e.getTileTypeAtCell(l-1,a))&&t.push({toMove:e.board[a][l-1],moveTo:o,type:n}),null!==(n=e.getTileTypeAtCell(l+1,a))&&t.push({toMove:e.board[a][l+1],moveTo:o,type:n}),null!==(n=e.getTileTypeAtCell(l,a-1))&&t.push({toMove:e.board[a-1][l],moveTo:o,type:n}),null!==(n=e.getTileTypeAtCell(l,a+1))&&t.push({toMove:e.board[a+1][l],moveTo:o,type:n});else{if(null!==(n=e.getTileTypeAtCell(l-1,a))&&n!==s&&s<i.default.TILE_TYPE_NORMAL_NUMBER){var r=!1;e.getTileTypeAtCell(l+1,a)===n&&e.getTileTypeAtCell(l+2,a)===n?r=!0:e.getTileTypeAtCell(l,a-1)===n&&e.getTileTypeAtCell(l,a-2)===n?r=!0:e.getTileTypeAtCell(l,a-1)===n&&e.getTileTypeAtCell(l,a+1)===n?r=!0:e.getTileTypeAtCell(l,a+1)===n&&e.getTileTypeAtCell(l,a+2)===n&&(r=!0),r&&t.push({toMove:e.board[a][l-1],moveTo:o,type:n})}if(null!==(n=e.getTileTypeAtCell(l+1,a))&&n!==s&&s<i.default.TILE_TYPE_NORMAL_NUMBER){var c=!1;e.getTileTypeAtCell(l-1,a)===n&&e.getTileTypeAtCell(l-2,a)===n?c=!0:e.getTileTypeAtCell(l,a-1)===n&&e.getTileTypeAtCell(l,a-2)===n?c=!0:e.getTileTypeAtCell(l,a-1)===n&&e.getTileTypeAtCell(l,a+1)===n?c=!0:e.getTileTypeAtCell(l,a+1)===n&&e.getTileTypeAtCell(l,a+2)===n&&(c=!0),c&&t.push({toMove:e.board[a][l+1],moveTo:o,type:n})}if(null!==(n=e.getTileTypeAtCell(l,a-1))&&n!==s&&s<i.default.TILE_TYPE_NORMAL_NUMBER){var u=!1;e.getTileTypeAtCell(l,a+1)===n&&e.getTileTypeAtCell(l,a+2)===n?u=!0:e.getTileTypeAtCell(l-1,a)===n&&e.getTileTypeAtCell(l-2,a)===n?u=!0:e.getTileTypeAtCell(l-1,a)===n&&e.getTileTypeAtCell(l+1,a)===n?u=!0:e.getTileTypeAtCell(l+1,a)===n&&e.getTileTypeAtCell(l+2,a)===n&&(u=!0),u&&t.push({toMove:e.board[a-1][l],moveTo:o,type:n})}if(null!==(n=e.getTileTypeAtCell(l,a+1))&&n!==s&&s<i.default.TILE_TYPE_NORMAL_NUMBER){var _=!1;e.getTileTypeAtCell(l,a-1)===n&&e.getTileTypeAtCell(l,a-2)===n?_=!0:e.getTileTypeAtCell(l-1,a)===n&&e.getTileTypeAtCell(l-2,a)===n?_=!0:e.getTileTypeAtCell(l-1,a)===n&&e.getTileTypeAtCell(l+1,a)===n?_=!0:e.getTileTypeAtCell(l+1,a)===n&&e.getTileTypeAtCell(l+2,a)===n&&(_=!0),_&&t.push({toMove:e.board[a+1][l],moveTo:o,type:n})}}}),t},gatherAdjoinedLines:function(){for(var e=this,t=[],o=[],l=[],a=0;a<i.default.BOARD_ROW_SIZE;a++){for(var n=[],s=0;s<i.default.BOARD_COLUMN_SIZE;s++)n.push({vertical:!1,horizonal:!1});l.push(n)}return this.cellList.forEach(function(a){var n=a.tile.type;if(n<i.default.TILE_TYPE_NORMAL_NUMBER){if(!l[a.y][a.x].horizonal&&e.getTileTypeAtCell(a.x+1,a.y)===n&&e.getTileTypeAtCell(a.x+2,a.y)===n){var s=[a,e.board[a.y][a.x+1],e.board[a.y][a.x+2]];l[a.y][a.x+1].horizonal=!0,l[a.y][a.x+2].horizonal=!0;for(var r=a.x+3;e.getTileTypeAtCell(r,a.y)===n;)l[a.y][r].horizonal=!0,s.push(e.board[a.y][r]),r++;t.push(s)}if(!l[a.y][a.x].vertical&&(l[a.y][a.x].vertical=!0,e.getTileTypeAtCell(a.x,a.y+1)===n&&e.getTileTypeAtCell(a.x,a.y+2)===n)){s=[a,e.board[a.y+1][a.x],e.board[a.y+2][a.x]],l[a.y+1][a.x].vertical=!0,l[a.y+2][a.x].vertical=!0;for(var c=a.y+3;e.getTileTypeAtCell(a.x,c)===n;)l[c][a.x].vertical=!0,s.push(e.board[c][a.x]),c++;o.push(s)}}}),t.concat(o)},gatherAdjoinedSpecialSpawns:function(e){for(var t=[],i=[],o=[],l=0;l<e.length;l++)for(var a=l+1;a<e.length;a++){for(var n=!1,s=0;s<e[l].length;s++)if(e[a].includes(e[l][s])){t.push(e[l][s]),n=!0;break}if(n)break}for(l=0;l<e.length;l++)if(e[l].length>=5){var r=this.localeSpawnCell(e[l],t);r&&i.push(r)}else if(4===e[l].length){var c=this.localeSpawnCell(e[l],t);c&&o.push(c)}return{time:t,line:o,match:i,length:t.length+o.length+i.length}},localeSpawnCell:function(e,t){for(var i=0,o=!1,l=0;l<this.justSwappedCells.length;l++)if(e.includes(this.justSwappedCells[l])){i=e.indexOf(this.justSwappedCells[l]),o=!0;break}o||(i=~~(Math.random()*e.length));for(var a=i;a<e.length+i;a++){var n=i%e.length;if(!t.includes[e[n]])return e[n]}return null},getTileTypeAtCell:function(e,t){return e<0||e>=i.default.BOARD_COLUMN_SIZE?null:t<0||t>=i.default.BOARD_ROW_SIZE?null:null===this.board[t][e].tile?null:this.board[t][e].tile.type},animateSwap:function(e,t){var l=o.default.localPositionFromTileCoords(e.x,e.y),a=o.default.localPositionFromTileCoords(t.x,t.y);cc.tween(e.tile.node).to(i.default.ANIMATE_DURATION_SWAP,{position:cc.v2(l.x,l.y)}).start(),cc.tween(t.tile.node).to(i.default.ANIMATE_DURATION_SWAP,{position:cc.v2(a.x,a.y)}).start()},animateSwapForthBack:function(e,t){var l=o.default.localPositionFromTileCoords(e.x,e.y),a=o.default.localPositionFromTileCoords(t.x,t.y);cc.tween(e.tile.node).to(i.default.ANIMATE_DURATION_SWAP,{position:cc.v2(a.x,a.y)}).to(i.default.ANIMATE_DURATION_SWAP,{position:cc.v2(l.x,l.y)}).start(),cc.tween(t.tile.node).to(i.default.ANIMATE_DURATION_SWAP,{position:cc.v2(l.x,l.y)}).to(i.default.ANIMATE_DURATION_SWAP,{position:cc.v2(a.x,a.y)}).start()},animateAdjoin:function(e){var t=this;e.forEach(function(e){e.forEach(function(e){if(null!==e.tile){var o=e.tile;e.tile=null,cc.tween(o.node).to(i.default.ANIMATE_DURATION_ADJOIN,{scale:{value:0,easing:"sineOutIn"}}).call(function(){t.tilePool.put(o.node)}).start()}})})},animateDropTiles:function(e){e.forEach(function(e){var t=o.default.localPositionFromTileCoords(e.x,e.y);cc.tween(e.tile.node).to(i.default.ANIMATE_DURATION_DROP_TILES,{position:cc.v2(t.x,t.y)}).start()})},animateDropGeneratedTiles:function(e,t){e.forEach(function(e){var l=e.tile;l.node.y=Math.max(l.node.y+200,390);var a=o.default.localPositionFromTileCoords(e.x,e.y);cc.tween(l.node).delay(i.default.ANIMATE_DURATION_DROP_GENERATED_TILES_BREAK_EACH_ROW*(e.y-t)).to(i.default.ANIMATE_DURATION_DROP_GENERATED_TILES_EACH_ROW,{position:cc.v2(a.x,a.y)}).start()})},animateReshuffleBoard:function(){var e=this;this.cellList.forEach(function(t){if(t.tile){var l=t.tile;t.tile=null;var a=o.default.localPositionFromTileCoords(t.x,t.y);cc.tween(l.node).delay(i.default.ANIMATE_DURATION_CLEAR_BOARD_BREAK_EACH_ROW*t.y).to(i.default.ANIMATE_DURATION_CLEAR_BOARD_EACH_ROW,{position:cc.v2(a.x,Math.min(a.y-200,-290)),opacity:0}).call(function(){e.tilePool.put(l.node)}).start()}})},onTouch:function(e){if(this.ingameCtor.isPlaying){var t=this.node.convertToNodeSpaceAR(e.getLocation()),i=o.default.tileCoordsFromlocalPosition(t.x,t.y);i.spriteInBound?this.selected=this.board[i.y][i.x]:this.selected=null}},onTouchMove:function(e){if(this.ingameCtor.isPlaying&&this.selected){var t=this.node.convertToNodeSpaceAR(e.getLocation()),i=o.default.tileCoordsFromlocalPosition(t.x,t.y);!i.spriteInBound||this.selected.x===i.x&&this.selected.y===i.y||Math.abs(i.x-this.selected.x)+Math.abs(i.y-this.selected.y)<=1&&(this.swapTileAtCell(this.selected,this.board[i.y][i.x]),this.selected=null)}},onTouchEnded:function(){this.ingameCtor.isPlaying&&(this.selected=null)}}),cc._RF.pop()},{"./constants":"constants","./libs/helpers":"helpers","./objects/Tile":"Tile"}],IngameCtor:[function(e,t){"use strict";cc._RF.push(t,"14ba6kJELlDmpaThJABQGdw","IngameCtor"),a(e("./BoardCtor"));var i=a(e("./constants")),o=a(e("./libs/helpers")),l=a(e("./UICtor"));function a(e){return e&&e.__esModule?e:{default:e}}cc.Class({extends:cc.Component,properties:{uiController:l.default,isPlaying:{get:function(){return this._isGameStart&&!this._isAnimating&&!this._isPaused}}},onLoad:function(){this.board=this.getComponent("BoardCtor"),this.uiController.ingameController=this},start:function(){this._isGameStart=!1,this._isAnimating=!1,this.board.init(),this._level=0,this.setNewLevel()},resetLevelInfo:function(){this._startTime=o.default.getLevelTime(this._level),this._time=o.default.getLevelTime(this._level),this._targetScore=o.default.getLevelScore(this._level),this._score=0,this.uiController.updateStartTime(this._startTime),this.uiController.updateTime(this._time),this.uiController.updateTargetScore(this._targetScore),this.uiController.updateScore(this._score)},update:function(e){this._isGameStart&&(this._time-=1e3*e,this.uiController.updateTime(this._time),this._time<=0&&!this._isAnimating&&this.endGame())},addScore:function(e){this._score+=e,this.uiController.updateScore(this._score)},addTime:function(e){this._time=Math.min(this._time+1e3*e,this._startTime),this.uiController.updateTime(this._time)},checkForLevelCompleted:function(){return this._score>=this._targetScore},pauseGameForAnimating:function(){this._isAnimating=!0},resumeGameFromAnimating:function(){this._isAnimating=!1},nextLevel:function(){var e=this;this._level++,this._isGameStart=!1,this.board.animateReshuffleBoard(),this.scheduleOnce(function(){e.setNewLevel()},i.default.ANIMATE_DURATION_CLEAR_BOARD_EACH_ROW+i.default.ANIMATE_DURATION_CLEAR_BOARD_BREAK_EACH_ROW*i.default.BOARD_ROW_SIZE)},setNewLevel:function(){var e=this;this.uiController.showNextLevelNotification(this._level),this.scheduleOnce(function(){e.resetLevelInfo(),e.board.currentChain=0,e.pauseGameForAnimating(),e.board.generateTiles(!1),e.scheduleOnce(function(){e._isGameStart=!0},i.default.ANIMATE_DURATION_DROP_GENERATED_TILES_EACH_ROW+i.default.ANIMATE_DURATION_DROP_GENERATED_TILES_BREAK_EACH_ROW*i.default.BOARD_ROW_SIZE)},i.default.ANIMATE_DURATION_NOTIF_SHOW+i.default.ANIMATE_DURATION_NOTIF_WAIT)},pauseGame:function(){this._isPaused=!0,this.uiController.show("pause"),this.scheduleOnce(function(){cc.director.pause()},i.default.ANIMATE_DURATION_POPUP_SHOW)},resumeGame:function(){cc.director.resume(),this._isPaused=!1,this.uiController.hide("pause")},endGame:function(){var e=this;this._isGameStart=!1,this.uiController.shoWOutOfTimeNotification(),this.scheduleOnce(function(){e.uiController.show("result")},i.default.ANIMATE_DURATION_NOTIF_SHOW+i.default.ANIMATE_DURATION_NOTIF_WAIT+i.default.ANIMATE_DURATION_NOTIF_HIDE)},restartGame:function(){cc.director.resume(),cc.director.loadScene("ingame")},quitGame:function(){cc.director.resume(),cc.director.loadScene("landing")}}),cc._RF.pop()},{"./BoardCtor":"BoardCtor","./UICtor":"UICtor","./constants":"constants","./libs/helpers":"helpers"}],LandingCtor:[function(e,t){"use strict";cc._RF.push(t,"55339on/wRL07IkyMYu8FJw","LandingCtor"),cc.Class({extends:cc.Component,properties:{},start:function(){},onPlayClicked:function(){cc.director.loadScene("ingame")}}),cc._RF.pop()},{}],Tile:[function(e,t){"use strict";cc._RF.push(t,"d4edekFanxESLFqIaLf7XiX","Tile");var i=l(e("../libs/helpers")),o=l(e("../constants"));function l(e){return e&&e.__esModule?e:{default:e}}cc.Class({extends:cc.Component,properties:{typeSpriteFrames:[cc.SpriteFrame],debugLabel:cc.Label},start:function(){},setup:function(e,t){this.type=e,this.cell=t,this.isSpecial=this.type>=o.default.TILE_TYPE_NORMAL_NUMBER,this.getComponent(cc.Sprite).spriteFrame=this.typeSpriteFrames[e];var l=i.default.localPositionFromTileCoords(t.x,t.y);this.node.scale=this.getDefaultScale(),this.node.opacity=255,this.node.x=l.x,this.node.y=l.y,this.node.width=o.default.TILE_SPRITE_SIZE,this.node.height=o.default.TILE_SPRITE_SIZE,this.debugLabel.node.active=!1},update:function(){this.debugLabel.string="("+this.cell.x+", "+this.cell.y+")\n"+this.type},getDefaultScale:function(){return this.isSpecial?o.default.TILE_SPECIAL_SCALE:1}}),cc._RF.pop()},{"../constants":"constants","../libs/helpers":"helpers"}],UICtor:[function(e,t){"use strict";cc._RF.push(t,"32604sN3YpLH7A3Rg8oHRNn","UICtor");var i=l(e("./constants")),o=l(e("./libs/helpers"));function l(e){return e&&e.__esModule?e:{default:e}}cc.Class({extends:cc.Component,properties:{timeProgressBar:cc.ProgressBar,scoreProgressBar:cc.ProgressBar,scoreLabel:cc.Label,targetScoreLabel:cc.Label,timeLabel:cc.Label,popupOverlay:cc.Node,pausePopup:cc.Node,resultPopup:cc.Node,reshuffleNotification:cc.Node,nextLevelNotification:cc.Node,nextLevelNotificationLabel:cc.Label,timeoutNotification:cc.Node},onLoad:function(){this.popupOverlay.active=!1,this.pausePopup.active=!1,this.resultPopup.active=!1,this.reshuffleNotification.active=!1,this.nextLevelNotification.active=!1,this.timeoutNotification.active=!1},start:function(){},updateStartTime:function(e){this.startTime=e},updateTime:function(e){e=Math.max(0,e),this.timeLabel.string=o.default.formatTimer(e),this.timeProgressBar.progress=e/this.startTime},updateTargetScore:function(e){this.targetScore=e,this.targetScoreLabel.string=e},updateScore:function(e){this.scoreLabel.string=e,this.scoreProgressBar.progress=e/this.targetScore},show:function(e){this.popupOverlay.active=!0;var t=null;switch(e){case"pause":t=this.pausePopup;break;case"result":t=this.resultPopup}null!==t&&(t.active=!0,t.scale=0,cc.tween(t).to(i.default.ANIMATE_DURATION_POPUP_SHOW,{scale:1}).start())},hide:function(e){this.popupOverlay.active=!1;var t=null;switch(e){case"pause":t=this.pausePopup;break;case"result":t=this.resultPopup}null!==t&&cc.tween(t).to(i.default.ANIMATE_DURATION_POPUP_SHOW,{scale:0}).call(function(){t.active=!0}).start()},showNextLevelNotification:function(e){this.nextLevelNotificationLabel.string="Level "+(e+1),this.nextLevelNotification.active=!0,this.nextLevelNotification.opacity=0,this.nextLevelNotification.y=-100,cc.tween(this.nextLevelNotification).to(i.default.ANIMATE_DURATION_NOTIF_SHOW,{position:cc.v2(0,0),opacity:255}).delay(i.default.ANIMATE_DURATION_NOTIF_WAIT).to(i.default.ANIMATE_DURATION_NOTIF_HIDE,{position:cc.v2(0,-100),opacity:0}).start()},showReshuffleNotification:function(){this.reshuffleNotification.active=!0,this.reshuffleNotification.opacity=0,this.reshuffleNotification.y=-100,cc.tween(this.reshuffleNotification).to(i.default.ANIMATE_DURATION_NOTIF_SHOW,{position:cc.v2(0,0),opacity:255}).delay(i.default.ANIMATE_DURATION_NOTIF_WAIT).to(i.default.ANIMATE_DURATION_NOTIF_HIDE,{position:cc.v2(0,-100),opacity:0}).start()},shoWOutOfTimeNotification:function(){this.timeoutNotification.active=!0,this.timeoutNotification.opacity=0,this.timeoutNotification.y=-100,cc.tween(this.timeoutNotification).to(i.default.ANIMATE_DURATION_NOTIF_SHOW,{position:cc.v2(0,0),opacity:255}).delay(i.default.ANIMATE_DURATION_NOTIF_WAIT).to(i.default.ANIMATE_DURATION_NOTIF_HIDE,{position:cc.v2(0,-100),opacity:0}).start()},pauseClicked:function(){this.ingameController.pauseGame()},resumeClicked:function(){this.ingameController.resumeGame()},quitClicked:function(){this.ingameController.quitGame()},restartClicked:function(){this.ingameController.restartGame()}}),cc._RF.pop()},{"./constants":"constants","./libs/helpers":"helpers"}],constants:[function(e,t,i){"use strict";cc._RF.push(t,"027081N1wNHhZgaQobZoi8J","constants"),i.__esModule=!0,i.default=void 0,i.default={TILE_TYPE_NORMAL_NUMBER:5,TILE_TYPE_INDEX_SPECIAL_LINE:5,TILE_TYPE_INDEX_SPECIAL_TIME:6,TILE_TYPE_INDEX_SPECIAL_MATCH:7,TILE_TYPE_INDEX_SPECIAL_ROCK:8,TILE_SPECIAL_SCALE:1.3,TILE_SPECIAL_BONUS_TIME:15,TILE_SIZE:64,TILE_SPRITE_SIZE:52,BOARD_COLUMN_SIZE:7,BOARD_ROW_SIZE:7,LEVEL_SCORE:[3e3,6e3,1e4,15e3,21e3,28e3,35e3,42e3,49e3,56e3,61e3,68e3,75e3,82e3,9e4],LEVEL_TIME:[180,160,130,120,110,105,105,100,95,90,85,80,75,70,65,60],ANIMATE_DURATION_SWAP:.2,ANIMATE_DURATION_ADJOIN:.2,ANIMATE_DURATION_SPAWN_SPECIAL:.2,ANIMATE_DURATION_DROP_TILES:.2,ANIMATE_DURATION_DROP_GENERATED_TILES_EACH_ROW:.36,ANIMATE_DURATION_DROP_GENERATED_TILES_BREAK_EACH_ROW:.14,ANIMATE_DURATION_CLEAR_BOARD_EACH_ROW:.36,ANIMATE_DURATION_CLEAR_BOARD_BREAK_EACH_ROW:.1,ANIMATE_DURATION_SCORE_TEXT:.6,ANIMATE_DURATION_POPUP_SHOW:.2,ANIMATE_DURATION_NOTIF_SHOW:.3,ANIMATE_DURATION_NOTIF_WAIT:.5,ANIMATE_DURATION_NOTIF_HIDE:.3},t.exports=i.default,cc._RF.pop()},{}],helpers:[function(e,t){"use strict";cc._RF.push(t,"25b0ch0ZN5CTrLtkqwGvZ7C","helpers");var i,o=(i=e("../constants"))&&i.__esModule?i:{default:i};t.exports.getScoreScale=function(e){return 40+20*e},t.exports.localPositionFromTileCoords=function(e,t){return{x:(e-o.default.BOARD_COLUMN_SIZE/2+.5)*o.default.TILE_SIZE,y:(t-o.default.BOARD_ROW_SIZE/2+.5)*o.default.TILE_SIZE}},t.exports.tileCoordsFromlocalPosition=function(e,t){var i=o.default.TILE_SPRITE_SIZE/o.default.TILE_SIZE/2,l=(e+(o.default.BOARD_COLUMN_SIZE/2-.5)*o.default.TILE_SIZE)/o.default.TILE_SIZE,a=(t+(o.default.BOARD_ROW_SIZE/2-.5)*o.default.TILE_SIZE)/o.default.TILE_SIZE,n=Math.round(l),s=Math.round(a);return{x:n,y:s,spriteInBound:Math.abs(l-n)<=i&&Math.abs(a-s)<=i&&n>=0&&n<o.default.BOARD_COLUMN_SIZE&&s>=0&&s<o.default.BOARD_ROW_SIZE}},t.exports.formatDurationDHMSObject=function(e){e=Math.max(0,e);var t=Math.ceil(e/1e3),i=Math.floor(t/60),o=Math.floor(i/60),l=Math.floor(o/24);return{seconds:t%=60,minutes:i%=60,hours:o%=24,days:l}},t.exports.formatTimer=function(e){var t=this.formatDurationDHMSObject(e),i=t.seconds,o=t.minutes,l=t.hours,a=t.days,n=o>9||0===l?o:"0"+o,s=i>9?i:"0"+i;return a>=1?a+":"+l+":"+o+":"+i:l>=1?l+":"+n+":"+s:n+":"+s},t.exports.getLevelScore=function(e){return e<o.default.LEVEL_SCORE.length?o.default.LEVEL_SCORE[e]:o.default.LEVEL_SCORE[o.default.LEVEL_SCORE.length-1]+5e3*(e-o.default.LEVEL_SCORE.length+1)},t.exports.getLevelTime=function(e){return 1e3*o.default.LEVEL_TIME[Math.min(e,o.default.LEVEL_TIME.length-1)]},cc._RF.pop()},{"../constants":"constants"}]},{},["BoardCtor","IngameCtor","LandingCtor","UICtor","constants","helpers","Tile"]);